## Функция: `listVacancy`

### Structure

Функция `listVacancy` организована в соответствии с принципами чистой архитектуры и разделена на
уровни `data`, `domain` и ``presentation``:

- **Data Layer:** Управляет операциями с данными и источниками (сеть и база данных).
- Он содержит модели для сети и database storage и включает хранилища для управления потоком данных.

- **Domain Layer:** Содержит бизнес-логику, включая мапперы, модели и сценарии использования,
- которые работают независимо от внешних источников данных или фреймворков.

- **Presentation Layer:** Управляет состоянием пользовательского интерфейса, взаимодействием и
- оркестровкой бизнес-логики с помощью ViewModel и моделей, специфичных для пользовательского
  интерфейса.

### Документация по слоям и классам

### **Data Layer**

Этот слой взаимодействует с сетевыми источниками и базами данных, предоставляя данные доменному
слою.

#### Models

1. **`ModelListResponseOfferAndVacancies`**Модель, представляющая сетевой ответ, включающий списки
   предложений и вакансий.
   Сериализуется с помощью `@Serializable` для передачи по сети.

2. **`DataModelListVacancyOffer`** Представляет предложение в сетевой модели. Включает такие поля,
   как `id`, `title`, `link` и необязательную `кнопку`.

3. **`DataModelListVacancy`** Представляет вакансию в сетевой модели. Содержит такие свойства,
   как `id`, `lookingNumber`, `title`, `address`, `company` и т. д.

4. **`Button`, `DataModelListAddress`, `DataModelListExperience`, `DataModelListSalary`** Это
   вложенные классы данных,
   используемые в `DataModelListVacancy` для представления специфических компонентов, таких как
   адрес, опыт, зарплата и детали кнопки.

#### Repository

1. **`ListVacancyRepositoryImpl`** Реализует `ListVacancyRepository`, управляя получением данных из
   локальной базы
   данных (`LocalDataSource`) и сети (`RemoteDataSource`). Он также:


- Получает вакансии и предложения как из БД, так и из сети.

- Запускает операции загрузки сети для обновления кэша.

- Сопоставляет модели с объектами домена с помощью `listVacancyDataMapper`
  и `listVacOfferDataMapper`.

- Предоставляет методы для сохранения и удаления избранного.


3. **`LocalDataSource`** Управляет доступом к базе данных для вакансий, предложений и избранных
   данных,
   обеспечивая доступ к спискам вакансий и предложений на основе Flow из интерфейсов Room DAO.

4. **`RemoteDataSource`** Служит для получения данных из удаленных источников,
   используя `HttpClient` и `UrlProvider` для управления URL. Он разбирает ответы с помощью
   десериализации JSON и
   управляет обработкой исключений для сетевых проблем.

### **Domain Layer**

Доменный слой инкапсулирует бизнес-логику и преобразования данных.

#### Mappers

1. **`ListVacancyDataMapper`**


- Сопоставляет данные между моделями вакансий сети, базы данных и домена.

- Поддерживает методы преобразования:


- Сеть в домен.

- Базы данных в домен.

- Домен в базу данных для кэширования и сохранения.


3. **`ListVacOfferDataMaper`**


- Сопоставляет данные о предложениях между сетевой моделью, моделью базы данных и моделью домена.

- Подобно `ListVacancyDataMapper`, он предоставляет методы для сопоставления между слоями для
  поддержания согласованности данных.

#### Models

1. **`ListOfferDomainModel`, `ListButton`** Доменные модели, представляющие предложение и кнопку,
   для последовательного использования в доменном и презентационном слоях.

2. **`ListVacancyDomainModel` и вложенные модели** Представляют вакансию в доменном слое.
   Включает в себя подмодели для адреса, опыта и зарплаты, обеспечивая четкое разделение моделей
   пользовательского интерфейса и слоя данных.

#### Repository Interface

1. **`ListVacancyRepository`** Определяет контракт для `ListVacancyRepositoryImpl`, определяя
   операции с данными для получения вакансий и
   предложений, управления избранным и запуска обновлений сети.

#### Use Cases

1. **`FavoriteUseCase`** Предоставляет бизнес-логику для управления избранными вакансиями путем
   добавления или
   удаления вакансий в хранилище. Абстрагирует операции с базой данных от пользовательского
   интерфейса.

2. **`ListVacancyUseCase`** Организует получение данных о вакансиях и предложениях из хранилища и
   запускает операции загрузки сети. В этом слое обеспечивается выполнение только необходимых
   преобразований данных и бизнес-логики.

### **Presentation**

Управляет взаимодействием с пользователем, состоянием представления и привязкой данных к компонентам
пользовательского интерфейса.

#### Adapters

1. **`ListVacancyAdapter`** Управляет списком вакансий в `RecyclerView`. Поддерживает такие
   пользовательские взаимодействия, как:


- Просмотр большего количества вакансий (с пагинацией).

- Подача заявки на вакансию.

- Добавление/удаление вакансий из избранного.

- Каждый вид элемента обрабатывается отдельными view holders, `VacancyViewHolder` для элементов
  вакансий и `ShowMoreViewHolder` для пагинации.

3. **`ListVacOfferAdapter`** Отображает горизонтальный список предложений. Каждое предложение
   содержит
   необязательные сведения, такие как заголовок, ссылка и кнопка действия. Поддерживает события
   click для обработки взаимодействий.

#### Models

1. **`ListVacancyModel` и вложенные модели** UI-специфические представления данных о вакансиях для
   привязки
   в `ListVacancyAdapter`. Включает вложенные модели для `Address`, `Experience` и `Salary`.

2. **`ListOfferModel`, `ButtonModel`** UI-специфические модели для данных о предложениях,
   используемые в `ListVacOfferAdapter`.

#### ViewModel

1. **`ListVacancyViewModel`** Координирует работу между сценариями использования домена и
   компонентами пользовательского
   интерфейса, обеспечивая:

- Наблюдаемые элементы для списков вакансий и предложений с использованием `StateFlow`.
- Методы для обновления статуса избранных вакансий.
- Функции для наблюдения за потоками данных из сценариев использования `getVacanciesFromDB`
  и `getOffersFromDB`.
- Обработка ошибок для решения проблем с сетью или хранилищем.

2. **`ListVacanciesFragment`** UI-компонент, отвечающий за отображение списка вакансий и
   предложений,
   наблюдение за данными из `ListVacancyViewModel` и привязку к `ListVacancyAdapter`
   и `ListVacOfferAdapter`.
   Он инициализирует пользовательский интерфейс, управляет взаимодействием с представлениями и
   обрабатывает обновления данных.

---

### Dependency Injection with Koin

**`listVacancyModule`** определяет привязки Koin:

- Регистрирует `HttpClient`, `RemoteDataSource` и `LocalDataSource` для операций с данными.
- Предоставляет экземпляры мапперов и реализацию репозитория.
- Связывает сценарии использования и `ListVacancyViewModel`, обеспечивая внедрение зависимостей в
  соответствии с уровнями Clean Architecture.